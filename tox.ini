[tox]
envlist = py39,py310,py311,py312,py313
isolated_build = true
skipsdist = false

[testenv]
# Install package in editable mode
deps = 
    pytest
    pytest-asyncio
    pytest-cov
commands = 
    python quick_test.py
    python run_full_ci.py

[testenv:py39]
basepython = python3.9

[testenv:py310]
basepython = python3.10

[testenv:py311]
basepython = python3.11

[testenv:py312]
basepython = python3.12

[testenv:py313]
basepython = python3.13

# Quick smoke test across all versions
[testenv:smoke]
envlist = py39,py310,py311,py312,py313
commands = python quick_test.py

# Full CI test across all versions  
[testenv:fullci]
envlist = py39,py310,py311,py312,py313
commands = python run_full_ci.py

# Linting and formatting
[testenv:lint]
basepython = python3.12
deps = 
    black
    flake8
    isort
    mypy
commands = 
    black --check pure3270/
    flake8 pure3270/
    isort --check-only pure3270/

[testenv:format]
basepython = python3.12
deps = 
    black
    isort
commands = 
    black pure3270/
    isort pure3270/

# Coverage reporting
[testenv:coverage]
basepython = python3.12
deps = 
    pytest
    pytest-asyncio
    pytest-cov
commands = 
    pytest tests/ --cov=pure3270 --cov-report=html --cov-report=xml --cov-report=term

[flake8]
max-line-length = 88
extend-ignore = E203,W503
exclude = .git,__pycache__,build,dist,.tox,.venv

[coverage:run]
source = pure3270
omit = 
    pure3270/__init__.py
    */tests/*
    */test_*
    setup.py

[coverage:report]
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.: